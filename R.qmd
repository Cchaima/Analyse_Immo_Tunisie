---
title: "<span style='color:#1f77b4'>Analyse Stratégique :</span> <span style='color:#ff7f0e'>Immobilier en Tunisie</span>"
author: "<span style='color:#2ca02c'>Chaima Hajri</span>"
format:
  html:
    theme: cosmo
    toc: true
    toc-depth: 2
    code-fold: true
    fig-width: 8
    fig-height: 5
editor: source
---
```{r}
#| label: setup
#| include: false

# 1. Chargement des librairies nécessaires
library(tidyverse)
library(scales)
library(plotly)
library(knitr)

# 2. Chargement du dataset
df <- read_csv("dataset_clean.csv", show_col_types = FALSE)

# 3. Nettoyage et préparation des données
# On crée df_clean dès le début pour qu'il soit disponible pour tout le document
df_clean <- df %>%
  select(
    price = price_tnd,
    area = Area,
    governorate = governorate,
    room = room
  ) %>%
  mutate(
    price = as.numeric(price),
    area = as.numeric(area),
    governorate = str_to_title(str_trim(as.character(governorate)))
  ) %>%
  # Filtrage des valeurs aberrantes pour une analyse cohérente
  filter(price > 10000 & price < 5000000) %>% 
  filter(area > 10 & area < 1000) %>%
  drop_na()

# Création d'un échantillon pour les graphiques de points (optimisation mémoire)
df_light <- df_clean %>% sample_n(min(2000, nrow(df_clean)))
```
Introduction
Cette étude présente une analyse exploratoire du marché immobilier tunisien. L'objectif est de comprendre comment le prix des biens est influencé par la surface et la localisation géographique, tout en offrant une vision claire de la distribution de l'offre.

1. Description des Données
Le jeu de données utilisé regroupe des annonces immobilières extraites et nettoyées. Voici les variables principales utilisées dans ce rapport :

## 1. Description des Données

Le jeu de données utilisé regroupe des annonces immobilières extraites et nettoyées. Voici les variables principales utilisées dans ce rapport :

| Variable | Description |
|:----------|:----------------------------------------------------|
| **price** | Prix du bien en Dinars Tunisiens (TND). |
| **area** | Surface habitable en mètres carrés (m²). |
| **governorate** | Région administrative (Gouvernorat). |
| **room** | Nombre de pièces du logement (ex: S+1, S+2). |
1.2 Aperçu des données (5 premières lignes)
Ce tableau présente un échantillon des données prêtes à l'analyse :
```{r}
#| echo: true
kable(head(df_clean, 5))
```
1.3 Résumé Statistique
Voici les indicateurs clés (min, moyenne, max) pour les prix et les surfaces :

```{r}
#| echo: true
df_clean %>% 
  select(Prix_TND = price, Surface_m2 = area) %>% 
  summary()
```

2. Analyse de la Distribution des Prix
Ce graphique permet de visualiser si le marché est dominé par des biens accessibles ou des biens de luxe.
```{r}
#| label: plot-hist
#| echo: true

p1 <- ggplot(df_clean, aes(x = price)) +
  geom_histogram(bins = 30, fill = "#2C3E50", color = "white") +
  scale_x_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
  labs(title="Distribution des Prix Immobiliers", 
       x="Prix (Millions TND)", 
       y="Nombre de biens") +
  theme_minimal()

ggplotly(p1)
```

Analyse : On observe une concentration massive de l'offre sous la barre des 500 000 DT, ce qui indique un marché principalement résidentiel.

3. Relation entre Surface et Prix
L'objectif est de vérifier la corrélation entre la taille du bien et son coût final.

```{r}
#| label: plot-scatter
#| echo: true

p2 <- ggplot(df_light, aes(
    x = area,
    y = price,
    color = governorate,
    text = paste("Gouvernorat :", governorate, "<br>Surface :", area, "m²", "<br>Prix :", price, "DT")
  )) +
  geom_point(alpha = 0.6) +
  scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
  labs(title="Relation Surface – Prix par Région", 
       x="Surface (m²)", 
       y="Prix (TND)") +
  theme_minimal()

ggplotly(p2, tooltip = "text")
```
Analyse : La tendance est positive (plus de surface = prix plus élevé), mais la dispersion montre que le prix au m² varie énormément selon le gouvernorat choisi.

4. Disparités Régionales
Comparaison des prix pratiqués dans les différents gouvernorats.
```{r}
#| label: plot-box
#| echo: true

p3 <- ggplot(df_clean, aes(x = reorder(governorate, price), y = price, fill = governorate)) +
  geom_boxplot(show.legend = FALSE) +
  coord_flip() +
  scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
  labs(title="Variation des Prix par Gouvernorat", 
       x="Gouvernorat", 
       y="Prix (TND)") +
  theme_minimal()

ggplotly(p3)

```
Analyse : Ce graphique met en évidence les zones premium de la Tunisie où les prix médians et les valeurs extrêmes sont les plus élevés.


5. Analyse du Prix au m² par Gouvernorat

Le prix total dépend de la surface, mais le **prix au m²** est le véritable indicateur de la valeur foncière d'une région.

```{r}
#| echo: true
#| warning: false

# Calcul du prix moyen au m2 par ville
df_m2 <- df_clean %>%
  mutate(price_m2 = price / area) %>%
  group_by(governorate) %>%
  summarise(mean_m2 = mean(price_m2, na.rm = TRUE)) %>%
  arrange(desc(mean_m2))

p_m2 <- ggplot(df_m2, aes(x = reorder(governorate, mean_m2), y = mean_m2)) +
  geom_segment(aes(xend=governorate, yend=0), color="grey") +
  geom_point(size=4, color="#E74C3C") +
  coord_flip() +
  labs(title = "Classement : Prix Moyen au m²", 
       subtitle = "Quelle ville est la plus chère au mètre carré ?",
       x = "", y = "Prix Moyen (TND / m²)") +
  theme_minimal()

ggplotly(p_m2)
```
Analyse : Ce classement permet d'identifier les zones "Premium". On remarque souvent que certaines villes avec des prix totaux bas ont en réalité un prix au m² très élevé, signe de petits appartements de luxe.
---



6. Volume de l'Offre par Région

Où y a-t-il le plus de choix pour un acheteur ? Ce graphique montre la part de marché de chaque gouvernorat en nombre d'annonces.

```{r}
#| echo: true
#| warning: false

p_volume <- df_clean %>%
  count(governorate) %>%
  ggplot(aes(x = reorder(governorate, n), y = n, fill = n)) +
  geom_col() +
  scale_fill_gradient(low = "#AED6F1", high = "#2E86C1") +
  coord_flip() +
  labs(title = "Répartition du Volume d'Annonces", 
       x = "Gouvernorat", y = "Nombre de biens en vente") +
  theme_minimal() +
  theme(legend.position = "none")

ggplotly(p_volume)
```
Analyse : Une forte concentration d'annonces dans une région indique un marché très actif (liquide), tandis qu'un faible volume peut signaler un marché de niche ou une zone moins développée.
---



7. Impact des caractéristiques sur le prix

```{r}
#| echo: true
#| warning: false

# On regarde la répartition par nombre de pièces
p_rooms <- ggplot(df_clean, aes(x = factor(room), fill = factor(room))) +
  geom_bar() +
  labs(title = "Type de biens par nombre de pièces", 
       x = "Nombre de pièces", y = "Volume") +
  theme_minimal() +
  theme(legend.position = "none")

ggplotly(p_rooms)
```
8. Analyse du Prix au m² (Valeur Réelle)
Le prix total peut être trompeur si les surfaces varient. Le prix au m² est l'unité de mesure standard pour comparer la cherté réelle du foncier.
```{r}
#| echo: true
#| warning: false

# Calcul du prix moyen au m2
df_m2 <- df_clean %>%
  mutate(price_m2 = price / area) %>%
  group_by(governorate) %>%
  summarise(mean_m2 = mean(price_m2, na.rm = TRUE))

p_m2 <- ggplot(df_m2, aes(x = reorder(governorate, mean_m2), y = mean_m2)) +
  geom_point(size = 4, color = "#E74C3C") +
  geom_segment(aes(x = governorate, xend = governorate, y = 0, yend = mean_m2), color = "#E74C3C") +
  coord_flip() +
  labs(title = "Prix moyen au mètre carré par ville",
       x = "", y = "Prix (TND / m²)") +
  theme_minimal()

ggplotly(p_m2)
```
Analyse : Ce graphique "Lollipop" met en évidence les disparités de valeur entre les centres urbains et les zones périphériques. Les villes en haut de ce classement sont celles où la pression foncière est la plus forte.
9. Corrélation entre Pièces et Prix
Enfin, nous examinons comment le nombre de pièces (rooms) influence le prix final, ce qui permet de segmenter le marché entre studios, appartements familiaux et villas.
```{r}
#| echo: true
#| warning: false

p_rooms <- ggplot(df_clean %>% filter(room < 10), aes(x = factor(room), y = price, fill = factor(room))) +
  geom_violin(alpha = 0.5) +
  scale_y_continuous(labels = label_number(suffix = " M", scale = 1e-6)) +
  labs(title = "Distribution des prix par nombre de pièces",
       x = "Nombre de pièces", y = "Prix (Millions TND)") +
  theme_minimal() +
  theme(legend.position = "none")

ggplotly(p_rooms)
```
Analysee : Le diagramme en violon montre non seulement la moyenne, mais aussi la densité des prix. On remarque que pour un même nombre de pièces, l'éventail des prix peut être très large selon le standing et la localisation.










